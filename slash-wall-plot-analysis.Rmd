---
title: "Slash Wall Plot Analysis"
author: "Peter Smallidge"
date: "10/14/2020"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r, include=FALSE}
# Library: dplyr, expss, ggplot2, ggpubr, labeling, plyr,
#       tidyverse, skimr
library(tidyverse)
library(dplyr)
library(ggplot2)
library(plyr)
library(labeling)
library(ggpubr)
library(expss)
library(skimr)        ## install.packages("skimr")
# ALT plus hypen = <- (within chunk)
# ctrl plus shift plus m = %>% 
# ctrl + ALT + I = insert chunk
# filter rows, select columns
# 


```



<br>

# Read data files as csv located within the repository  
# Conduct basic visualization of the data  
## Use the function "skim" to provide summary statistics  

```{r}
setwd("~/R/slash-wall-vegetation")
input.data = read.table("plot-data-2019.csv", header = TRUE, sep = ",")
# str(input.data) displays the structure of the variables

plot.data <- input.data
#code below to convert character variables to factor variables. I don't think this is necessary.
#
  #select(harvest, location, low.spp, invasive.spp, mid.spp, upper.spp, vine.spp) %>% 
 # mutate_if(is.character,as.factor)

# These are redundant with the more thorough output of "skim"
#str(plot.data)
#glimpse(plot.data)
#names(plot.data)
#dim(plot.data)
skim(plot.data)
#skimr::skim_tee(plot.data) - same as previous line
table(plot.data$ba)

#the following does not work. Variable "maple" should be integer
#plot.data %>% 
#  mutate_at(vars(beech, maple, birch, hdwd,conifer),integer)

#the following does not work...note maple is "character"
#plot.data %>% 
#  cols(
#    maple=col_integer()
#  )

head(plot.data)

#

```

<br>

#Subset data, group by harvest x location

```{r}
# Sort and group data by site (harvest name + interior vs. control)
# https://cmdlinetips.com/2020/08/dplyr-groupby-and-summarize-group-by-one-or-more-variables/ 
# 

site <- plot.data %>% 
  filter(location =="interior" | location=="control") %>% 
  select(harvest, location, ba) %>% 
  group_by(harvest, location) %>% 
  summarize(basal_area = mean(ba, na.rm = TRUE))

site


```

```{r}

site_alt <- plot.data %>% 
   filter(!(location=="perimeter"))

#the equivalent filter result also comes from ...
  #filter(location =="interior" | location=="control")

site_alt %>% 
  group_by(harvest) %>% 
  summarize(basal_area=mean(ba))
#view(site_alt)

#write.table(site_alt, "site_BA_means.txt", sep="\t")

```



```{r}
# site %>% 
# pivot_wider(names_from = location,
#             values_from = basal_area)
  
#view(ba_summ)

#site %>% 
#  select(harvest, location, basal_area) %>% 
#  table()



```


```{r}
site <- plot.data %>% 
  filter(location =="interior" | location=="control") %>% 
  select(harvest, location, ba)

  head(site)

```


```{r}
site <- plot.data %>% 
  filter(location =="interior" | location=="control") %>% 
  select(harvest, location, ba) %>% 
  group_by(harvest, location)

head(site, n=20)
```


```{r}
site <- plot.data %>% 
  filter(location =="interior" | location=="control") %>% 
  select(harvest, location, ba) %>% 
  group_by(harvest, location) %>% 
  summarize(basal_area = mean(ba, na.rm = TRUE))

site

```

